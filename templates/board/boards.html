{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% load humanize %}

{% block title %}{{ board.name }}{% endblock %}

{% block content %}
<div class="container my-4">

  <!-- 🧭 Breadcrumb navigation -->
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb bg-body-tertiary p-3 rounded shadow-sm">
      <li class="breadcrumb-item">
        <a href="{% url 'home' %}" class="text-decoration-none">Boards</a>
      </li>
      <li class="breadcrumb-item active" aria-current="page">{{ board.name }}</li>
    </ol>
  </nav>

  <!-- 🏷️ Board Info -->
  <div class="card shadow-sm border-0 mb-4">
    <div class="card-body d-flex justify-content-between align-items-center flex-wrap">
      <div>
        <h3 class="card-title mb-1">{{ board.name }}</h3>
        <p class="text-muted mb-0">{{ board.description }}</p>
      </div>
      <a href="{% url 'board_topics:add_new_topic' board.slug %}" 
         class="btn btn-primary rounded-pill mt-3 mt-sm-0 px-4">
        ➕ New Topic
      </a>
    </div>
  </div>

  <!-- 💬 Topics Table -->
  <div class="card shadow-sm border-0">
    <div class="card-header bg-light">
      <h5 class="mb-0">Topics</h5>
    </div>
    <div class="card-body p-0">
      <table class="table table-hover mb-0 align-middle">
        <thead class="table-light">
          <tr>
            <th>Topic</th>
            <th>Starter</th>
            <th>Replies</th>
            <th>Views</th>
            <th>Last Updated</th>
          </tr>
        </thead>
        <tbody>
          {% for topic in topics %}
          <tr>
            <td>
              <a href="{% url 'board_topics:topic_posts' board.slug topic.topic_slug %}"
                 class="text-decoration-none fw-semibold">
                {{ topic.subject }}
              </a>
            </td>
            <td>{{ topic.created_by.username }}</td>
            <td>{{ topic.posts.count|add:"0" }}</td>
            <td>{{ topic.views }}</td>
            <td>{{ topic.updated_at|naturaltime }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5" class="text-center text-muted py-4">
              No topics yet. Be the first to
              <a href="{% url 'board_topics:add_new_topic' board.slug %}" class="text-decoration-none">create one</a>!
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- 📄 Pagination -->
  {% if topics.has_other_pages %}
  <nav aria-label="Topics pagination" class="mt-4">
    <ul class="pagination justify-content-center">
      {% if topics.has_previous %}
        <li class="page-item">
          <a class="page-link" href="?page={{ topics.previous_page_number }}">Previous</a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">Previous</span></li>
      {% endif %}

      {% for page_num in topics.paginator.page_range %}
        {% if topics.number == page_num %}
          <li class="page-item active"><span class="page-link">{{ page_num }}</span></li>
        {% else %}
          <li class="page-item"><a class="page-link" href="?page={{ page_num }}">{{ page_num }}</a></li>
        {% endif %}
      {% endfor %}

      {% if topics.has_next %}
        <li class="page-item">
          <a class="page-link" href="?page={{ topics.next_page_number }}">Next</a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">Next</span></li>
      {% endif %}
    </ul>
  </nav>
  {% endif %}

</div>
{% endblock %}
